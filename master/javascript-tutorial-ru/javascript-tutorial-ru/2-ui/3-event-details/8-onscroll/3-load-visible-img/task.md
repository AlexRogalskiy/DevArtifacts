importance: 4

---

# Загрузка видимых изображений

Задача, которая описана ниже, демонстрирует результативный метод оптимизации страницы.

С целью экономии трафика и более быстрой загрузки страницы изображения на ней заменяются на "макеты".

Вместо такого изображения:

```html
<img src="yozhik.jpg" width="128" height="128">
```

![|width="128" height="128"](https://js.cx/clipart/yozhik.jpg)

Стоит вот такое:

```html
<img *!*src="1.gif"*/!* width="128" height="128" *!*realsrc="yozhik.jpg"*/!*>
```

![|width="128" height="128"](https://js.cx/lazyimg/1.gif)

То есть настоящий URL находится в атрибуте `realsrc` (название атрибута можно выбрать любое). А в `src` поставлен серый GIF размера 1x1, и так как `width/height` правильные, то он растягивается, так что вместо изображения виден серый прямоугольник.

При этом, чтобы браузер загрузил изображение, нужно заменить значение `src` на то, которое находится в `realsrc`.

Если страница большая, то замена больших изображений на такие макеты существенно убыстряет полную загрузку страницы. Это особенно заметно в случае, когда на странице много анонсов новостей с картинками или изображений товаров, из которых многие находятся за пределами прокрутки.

Кроме того, для мобильных устройств JavaScript может подставлять URL уменьшенного варианта картинки.

Напишите код, который при прокрутке окна загружает ставшие видимыми изображения.

То есть, как только изображение попало в видимую часть документа -- в `src` нужно прописать правильный URL из `realsrc`.

Пример работы вы можете увидеть в `iframe` ниже, если прокрутите его:

[iframe src="solution"]

Особенности реализации:

- При начальной загрузке некоторые изображения должны быть видны сразу, до прокрутки. Код должен это учитывать.
- Некоторые изображения могут быть обычными, без `realsrc`. Их код не должен трогать вообще.
- Также код не должен перегружать уже показанное изображение.
- Желательно предусмотреть загрузку изображений не только видимых сейчас, но и на страницу вперед и назад от текущего места.

P.S. Горизонтальной прокрутки нет.